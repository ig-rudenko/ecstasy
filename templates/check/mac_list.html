{% extends 'check/device_info.html' %}
{% load static %}
{% block title %}
{{ dev.name }}
{% endblock %}

{% block content %}
<style>
.custom-popover {
    max-width: 100%;
    font-size: 16px;
    font-family: monospace;
}
</style>


    <h2 style="text-align: center">{{ dev.name }} ({{ dev.ip }})</h2>

    <div class="container text-center alert">
        <div class="row row-cols-auto">

            {# Включить/выключить #}
            <div class="col">
                {% if perms >= 2 %}
                    <div class="btn-group-vertical" role="group">
                      <button type="button" class="btn btn-outline-success" style="height: 19px; font-size: 10px; padding-top: 2px;"
                             onclick="reload_port('{{ port }}', '{{ desc }}', 'up')"
                             data-bs-toggle="tooltip" data-bs-placement="left"
                             data-bs-title="Включить порт">
                          ▲
                      </button>

                      <button type="button" class="btn btn-outline-danger" style="height: 19px; font-size: 10px; padding-top: 2px;"
                             onclick="reload_port('{{ port }}', '{{ desc }}', 'down')"
                             data-bs-toggle="tooltip" data-bs-placement="left"
                             data-bs-title="Выключить порт">
                          ▼
                      </button>
                    </div>
                {% endif %}

                {# Перезагрузить #}
                {% if perms >= 1 %}
                    {% csrf_token %}
                    <button type="button" class="btn btn-outline-warning" style="cursor: pointer"
                         onclick="reload_port('{{ port }}', '{{ desc }}', 'reload')"
                         data-bs-toggle="tooltip" data-bs-placement="top"
                         data-bs-title="Перезагрузить порт">
                        Reload
                    </button>
                {% endif %}
            </div>

            {# Имя порта #}
            <div class="col">
                <span class="btn btn-light position-relative">
                    {{ port }}

                    {# Тип порта медь/оптика #}
                        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill"
                              id="port-type"
                        >{{ port_type | lower }}
                        </span>
                </span>
            </div>

            {# Конфигурация порта #}
            <div class="col" id="port-config">

            </div>

            {# Ошибки на порту #}
            <div class="col" id="port-errors">

            </div>

        </div>
    </div>

    <h3 class="alert alert-primary">{{ desc }}</h3>

    <hr>

    {# Информация о интерфейсе #}
    <div class="container" id="port-info">{{ port_info | safe }}</div>

    <hr>

{#    Обновлять MAC автоматически   #}
    <div class="form-check form-switch" style="margin-bottom: 30px">
      <input class="form-check-input" type="checkbox" role="switch" id="auto-update-macs">
      <label class="form-check-label" for="auto-update-macs">Обновлять MAC автоматически</label>
    </div>


{# Таблица МАКОВ #}
    <div id="macs-table">
        <div class="d-flex align-items-center">
          <strong>Загрузка...</strong><span class=""> Некоторое оборудование может грузиться около 30 секунд</span>
          <div class="spinner-border ms-auto" role="status" aria-hidden="true"></div>
        </div>
    </div>

{% csrf_token %}
<input id="id-port" disabled hidden value="{{ port }}">
<input id="id-device_name" disabled hidden value="{{ dev.name }}">
<input id="id-desc" disabled hidden value="{{ desc }}">
{% endblock %}

{% block js %}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>

    {% if perms > 0 or request.user.is_superuser %}
        <script src="{% static 'js/port_control.js' %}"></script>
    {% endif %}

    <script src="{% static 'js/get_port_info.js' %}"></script>
{% endblock %}